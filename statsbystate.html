<!DOCTYPE html>
<html>
<head>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300&family=Indie+Flower&display=swap" rel="stylesheet">
   <script src="https://kit.fontawesome.com/cbb1ed9207.js" crossorigin="anonymous"></script>
</head>
<body>
<center><h1>Covid-19 Tracker Nepal</h1></center>
<div>
	<label for="cars"><h3>Choose a State:</label>

<select name="states" id="states" onchange="myfunction()">
  <option value="none" selected disabled>Select One</option>	
  <option value="1">State-1</option>
  <option value="2">State-2</option>
  <option value="3" >Bagmati Pradesh</option>
  <option value="4">Gandaki Pradesh	</option>
  <option value="5">State-5</option>
  <option value="6">Karnali Pradesh	</option>
  <option value="7">Far Western Province	</option>
</select></h3>
</div>

<div class="container">
	<div class="flex-item item-1">
		<h1>Active Cases<br><br><i class="fas fa-head-side-cough"></i></h1><p id="stcount"></p>
	</div>
	<div class="flex-item item-2">
		<h1>Deaths<br><br><i class="fas fa-biohazard"></i></h1><p id="dtcount"></span></p>
	</div>
	<div class="flex-item item-3">
		<h1>Total Recovered<br><br><i class="fas fa-head-side-mask"></i></h1><p id="rtcount"></p>
	</div>
	<div class="flex-item item-4">
		<h1>Total Cases<br><br><i class="fas fa-head-side-mask"></i></h1><p id="tscount"></p>
	</div>
</div>

<script>
var settings = {
  "url": "https://data.nepalcorona.info/api/v1/covid/summary",
  "method": "GET",
  "timeout": 0,
  "headers": {
    "Content-Type": "application/json"
  },
};

$.ajax(settings).done(function (response) {
	
			a=[response];   			
});

function myfunction(){
	var states=document.getElementById("states").value;
	$('#stcount').empty();
	$('#stateno').empty();
	$('#dtcount').empty();
	$('#rtcount').empty();
	$('#tscount').empty();
	$("#container").css("display", "block");


		a.map((sname) => {
				  sname.province.active.map((i) => {
				    if(i.province == states) {
				      $('#stcount').append(Intl.NumberFormat('en-US').format(i.count))
				      $('#stateno').append(i.province)
				    }
				  })
			})

			a.map((sname) => {
				  sname.province.deaths.map((i) => {
				    if(i.province == states) {
				      $('#dtcount').append(Intl.NumberFormat('en-US').format(i.count))
				      
				    }
				  })
			})

			a.map((sname) => {
				  sname.province.recovered.map((i) => {
				    if(i.province == states) {
				      $('#rtcount').append(Intl.NumberFormat('en-US').format(i.count))
				      
				    }
				  })
			})


		a.map((sname) => {
				  sname.province.cases.map((i) => {
				    if(i.province == states) {
				      $('#tscount').append(Intl.NumberFormat('en-US').format(i.count))
				      				    }
				  })
			})

}
</script>
</body>
</html>
